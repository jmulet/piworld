require.config({baseUrl:"/",waitSeconds:30,paths:{underscore:"https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.4/underscore-min",text:"assets/libs/requirejs/require-text",css:"assets/libs/requirejs/require-css",async:"assets/libs/requirejs/require-async",font:"assets/libs/requirejs/require-font",image:"assets/libs/requirejs/require-image",json:"assets/libs/requirejs/require-json",noext:"assets/libs/requirejs/require-noext",mathjs:"activities/libs/math/mathjs",fraction:"activities/libs/math/fraction",
KAS:"activities/libs/math/KAS",canvaspaint:"activities/libs/math/mathinput/canvas-painter",mathquill:"activities/libs/math/mathinput/mathquill/mathquill.min",mathquilleditor:"activities/libs/math/mathinput/mathquill-editor",mathpaint:"activities/libs/math/mathinput/mathpaint",mathinput:"activities/libs/math/mathinput/mathinput",mathblanks:"activities/libs/math/mathinput/mathblanks","activity-quizz":"activities/libs/activity-quizz","activity-bakejson":"activities/libs/activity-bakejson","quizzrenderer-input":"activities/libs/quizzrenderer-input",
"quizzrenderer-blanks":"activities/libs/quizzrenderer-blanks","quizzrenderer-checkbox":"activities/libs/quizzrenderer-checkbox","quizzrenderer-kahoot":"activities/libs/quizzrenderer-kahoot","quizzrenderer-mathinput":"activities/libs/quizzrenderer-mathinput","quizzrenderer-radio":"activities/libs/quizzrenderer-radio","quizzrenderer-roots":"activities/libs/quizzrenderer-roots",mqEdtPalette:"activities/libs/math/mathinput/mathquill-editor-palette.html",mqEdtCss:"activities/libs/math/mathinput/mathquill-editor",
"jquery-draggable":"assets/libs/jquery/jquery-draggable","mobile-dnd":"assets/libs/DragDropTouch",rateyo:"assets/libs/jquery/jquery.rateyo.min",katex:"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.8.2/katex.min",katexauto:"https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.8.2/contrib/auto-render.min",jsxgraph:"https://cdnjs.cloudflare.com/ajax/libs/jsxgraph/0.99.6/jsxgraphcore"},shim:{underscore:{exports:"_"},katexauto:{deps:["katex"]},KAS:{deps:["underscore"]},jsxgraph:{deps:["css!https://cdnjs.cloudflare.com/ajax/libs/jsxgraph/0.99.6/jsxgraph.css"]},
mathpaint:{deps:["canvaspaint"]},mathquilleditor:{deps:["mathquill"],exports:"MQ"},mathquill:{deps:["css!/activities/libs/math/mathinput/mathquill/mathquill.css"]},mathinput:{deps:["mathquilleditor","mathpaint"]},"activity-quizz":{deps:["activity-bakejson","mobile-dnd"]}}});
(function(){function g(a){var c=new $.Deferred;c.resolve(a);return c.promise()}var w=["ca","es","en"],m,n,k,b=window.pw||{data:{}};b.Router=function(){};b.Router.prototype={go:function(a){b.log("Route transition; from=",this.route," to=",a);if(a!==this.route&&this.routes){this.routes.LoadingPanel.hide();var c=this;$.each(Object.keys(this.routes),function(b,d){var f=c.routes[d];d===a&&f.show?f.show():d!==a&&f.hide&&f.hide()})}this.route=a},setRoutes:function(a){this.routes=a}};var s=window.navigator.userAgent;
b.bowser={MSIE:!1,Firefox:!1,Chrome:!1,Safari:!1,version:0,mobile:/iPhone|iPad|iPod|Android/i.test(s)};for(var h=["Firefox","Chrome","Safari","MSIE","EDGE"],u=0;5>u;u++){var v=s.match(RegExp(h[u]+"/(.*)$","i"));if(v&&1<v.length){b.bowser[h[u]]=!0;s=s.match(/Version\/(.*)$/);v=v[1];s&&1<s.length&&(v=s[1]);try{b.bowser.version=parseInt(v.split(".")[0])}catch(t){}break}}b.i18n={ca:{USER:"Usuari",PLAY:"Jugar",PLAY_AGAIN:"Jugar de nou",EXIT:"Sortir",YOUR_SCORE:"La teva puntuacio",HOME:"Inici",NEXT:"Seg\u00fcent",
RIGHT_ANSWER:"Molt b\u00e9! Resposta correcta",THE_ANSWER:"La resposta era ",WRONG_ANSWER:"Resposta incorrecta",TRY_AGAIN:"Intenta de nou",CHECK:"Comprova la resposta",CHECKS:"Comprova les respostes",RATE:"Valora i comenta",SHARE:"Comparteix amb un amic",LOADING:"Carregant",LOGIN:"LOGIN",USERNAME:"Usuari",PASSWORD:"Contrasenya",CANCEL:"Cancel\u00b7la",CLOSE:"Tancar",ACCEPT:"Accepta",RANKING:"Posici\u00f3",PLAYER:"Jugador",SCORE:"Punts",NO_LIFES:":-( No et queden m\u00e9s vides",GAME_OVER:"Game Over",
CONGRATULATIONS:"Enhorabona!",LEVEL:"Nivell",CLICK_TO_EDIT:"Clica per editar la resposta",INVALID_INPUT:"Entrada invalida",HINTS:"Ajuda",TIME_OVER:"S'ha acabat el temps",YOUR_LEVEL:"El teu nivell"},es:{USER:"Usuario",PLAY:"Jugar",PLAY_AGAIN:"Jugar de nuevo",EXIT:"Salir",YOUR_SCORE:"Tu puntuacion",HOME:"Inicio",NEXT:"Siguiente",RIGHT_ANSWER:"Muy bien! Respuesta correcta",THE_ANSWER:"La respuesta era ",WRONG_ANSWER:"Respuesta incorrecta",TRY_AGAIN:"Intenta otra vez",CHECK:"Comprueba la respuesta",CHECKS:"Comprueba las respuestas",
RATE:"Valora la actividad",SHARE:"Comparte con un amigo",LOADING:"Cargando",LOGIN:"LOGIN",USERNAME:"Usuario",PASSWORD:"Contrase\u00f1a",CANCEL:"Cancela",CLOSE:"Cerrar",ACCEPT:"Aceptar",RANKING:"Posici\u00f3n",PLAYER:"Jugador",SCORE:"Puntos",NO_LIFES:":-( No te quedan mas vidas",GAME_OVER:"Game Over",CONGRATULATIONS:"Enhorabuena!",LEVEL:"Nivel",CLICK_TO_EDIT:"Clic para editar la respuesta",INVALID_INPUT:"Entrada invalida",HINTS:"Ayuda",TIME_OVER:"Se ha terminado el tiempo",YOUR_LEVEL:"Tu nivel"},en:{USER:"User",
PLAY:"Play",PLAY_AGAIN:"Play again",EXIT:"Exit",YOUR_SCORE:"Your score",HOME:"Home",NEXT:"Next",RIGHT_ANSWER:"Well done! Right answer",THE_ANSWER:"The answer was ",WRONG_ANSWER:"Wrong answer",TRY_AGAIN:"Try again",CHECK:"Check answer",CHECKS:"Check answers",RATE:"Rate the activity",SHARE:"Share with a friend",LOADING:"Loading",LOGIN:"LOGIN",USERNAME:"Username",PASSWORD:"Password",CANCEL:"Cancel",CLOSE:"Close",ACCEPT:"Accept",RANKING:"Ranking",PLAYER:"Player",SCORE:"Score",NO_LIFES:":-( No more lives left",
GAME_OVER:"Game Over",CONGRATULATIONS:"Congratulations",LEVEL:"Level",CLICK_TO_EDIT:"Clic to edit the answer",INVALID_INPUT:"Invalid input",HINTS:"Hints",TIME_OVER:"Time over",YOUR_LEVEL:"Your level"}};b.urlVars=function(){for(var a=[],c,b=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),d=0;d<b.length;d++)c=b[d].split("="),a.push(c[0]),a[c[0]]=c[1];return a}();b.urlVars.debug&&(b.DEBUG=!0);b.log=function(){b.DEBUG&&console.log.apply(console,arguments)};b.getI18n=function(a){return" "+
(b.i18n[b.getLang()]||b.i18n.en)[a]||" "+a};b.getLang=function(){if(k)return k;var a;(a=(a=document.cookie.match("(^|;) ?NG_TRANSLATE_LANG_KEY=([^;]*)(;|$)"))?a[2]:null)?k=a.replace(/"/g,"").replace(/%22/g,""):(a=b.getGroup())&&a.gopts&&a.gopts.lang?k=a.gopts.lang:(a=b.getUser())&&a.uopts&&a.uopts.lang?k=a.uopts.lang:(k=void 0!=navigator.languages?navigator.languages[0]:navigator.language,0<k.indexOf("-")&&(k=k.split("-")[0]));k=(k||"").toLowerCase();0>w.indexOf(k)&&(k="en");return k};b.LoadingSpinner=
{init:function(){this.spinner=$('<div class="pw-loader"><div class="pw-loader-bounce"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div>');$("body").append(this.spinner)},show:function(){this.spinner||b.LoadingSpinner.init();this.spinner.show()},hide:function(){this.spinner||b.LoadingSpinner.init();this.spinner.fadeOut(300)}};b.LoadingPanel=function(){this.mainPanel=$('<div class="loading-panel"></div>');this.message=$('<div class="loading-message">'+b.getI18n("LOADING")+
" ...</div>");this.warningMessage=$('<div class="loading-message loading-warning"></div>');this.dangerMessage=$('<div class="loading-message loading-danger"></div>');this.mainPanel.append(this.message);this.mainPanel.append(this.warningMessage);this.mainPanel.append(this.dangerMessage);$("body").append(this.mainPanel)};b.LoadingPanel.prototype={destroy:function(){$("body").remove(this.mainPanel);this.mainPanel=null},show:function(a,c,e){"undefined"!==typeof a&&this.mainPanel.html(a);"undefined"!==
typeof c&&this.warningMessage.html(c);"undefined"!==typeof e&&this.dangerMessage.html(e);this.mainPanel||this.create();this.mainPanel.show();b.LoadingSpinner.show()},danger:function(a){this.message.hide();this.dangerMessage.append("<p>"+a+"</p>");this.dangerMessage.show()},warning:function(a){this.warningMessage.append("<p>"+a+"</p>");this.warningMessage.show()},hide:function(){this.mainPanel&&(this.mainPanel.fadeOut(250),b.LoadingSpinner.hide())}};b.LoginModal={init:function(){var a='<div id="loginmodal" class="modal fade" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">Login to piWorld.es</h4></div><div class="modal-body"><label for="uname">'+
b.getI18n("USERNAME")+'</label><input id="uname" type="text" class="form-control" autocorrect="off" autocapitalize="none" autocomplete="off"/><br><label for="upwd" class="text-capitalize">'+b.getI18n("PASSWORD")+'</label><input id="upwd" type="password" class="form-control" /><br><div class="alert alert-danger" style="display:none"></div></div><div class="modal-footer"> <button type="button" class="btn btn-danger" data-dismiss="modal">'+b.getI18n("CANCEL")+'</button> <button id="authBtn" type="button" class="btn btn-success">'+
b.getI18n("ACCEPT")+"</button></div></div></div></div>",c=this;this.modal=$(a);$("body").append(this.modal);this.uname=this.modal.find("#uname");this.upwd=this.modal.find("#upwd");this.msg=this.modal.find(".alert");this.authBtn=this.modal.find("#authBtn");var e=function(){c.authBtn.prop("disabled",!0);var a={username:c.uname.val(),password:c.upwd.val()};$.ajax({type:"POST",url:"/rest/users/login",data:b.encrypt(JSON.stringify(a)),contentType:"text/plain;charset=UTF-8"}).then(function(a){c.authBtn.prop("disabled",
!1);a.ok?(m=JSON.parse(b.decrypt(a.user_info)),localStorage.setItem("pwSession",b.encrypt(JSON.stringify({user:m}))),0<m.groups.length&&(n=m.groups[0]),k=null,b.getLang(),c.modal.modal("hide")):(c.msg.show(),c.msg.html(a.msg))})};this.authBtn.on("click",e);this.upwd.keyup(function(a){13===a.which&&e()})},show:function(){this.modal||this.init();this.msg.hide();this.modal.modal();this.uname.focus()},onClose:function(a){this.modal.on("hidden.bs.modal",a)}};b.WelcomeScreen=function(a,c,e,d){this.router=
a;this.data=d;a='<div class="welcome"><a href="https://pw.es"><img class="piworld" src="/assets/img/logo.png"/></a><div id="welcomeUsername" class="lcd"></div><center><div id="atitle" style="margin-top:-50px"></div><div class="panel panel-default" style="background: rgba(255,255,255,0.9)";><div class="panel-header" style="padding:5px"><center><h3 style="margin:0px"><b class="lcd">Top 10</b></h3></center></div><div class="panel-body" style="height:300px; overflow-y:auto"><table class="table table-responsive table-stripped table-hover"><thead><tr><th>'+
b.getI18n("RANKING")+"</th><th>"+b.getI18n("USER")+"</th><th>"+b.getI18n("SCORE")+"</th><th>"+b.getI18n("LEVEL")+'</th></tr></thead><tbody id="tbody"></tbody></table></div></div><div id="playBtnDiv"><button id="loginBtn" class="btn btn-xl btn-info glyphicon glyphicon-user" style="display:none">'+b.getI18n("LOGIN")+'</button><button id="playBtn" class="btn btn-xl btn-success glyphicon glyphicon-play-circle" disabled="true">'+b.getI18n("PLAY")+"</button></div></center></div>";this.mainPanel=$(a);this.goButton=
this.mainPanel.find("#playBtn");this.loginButton=this.mainPanel.find("#loginBtn");this.username=this.mainPanel.find("#welcomeUsername");this.goButton.on("click",function(a){c&&c()});this.rest=e;$("body").append(this.mainPanel);this.tBody=this.mainPanel.find("#tbody");this.title=this.mainPanel.find("#atitle")};b.WelcomeScreen.prototype={destroy:function(){$("body").remove(this.mainPanel);this.goButton.off();this.mainPanel=null},show:function(){this.mainPanel||this.create();var a=this,c="";500===b.getUser().idRole&&
(c=" - Familia");a.username.text(b.getUser().username+c);b.getUser().id||(this.loginButton.show(),this.loginButton.on("click",function(c){b.LoginModal.show();b.LoginModal.onClose(function(){b.getUser().id&&(a.loginButton.hide(),a.username.text(b.getUser().username||""))})}));1===b.data.numPlays&&this.goButton.text(b.getI18n("PLAY_AGAIN"));a=this;this.rest.top10().then(function(c){var b="";$.each(c.top,function(a,c){var e={};try{e=JSON.parse(c.uopts)}catch(d){}b+="<tr><td>"+(a+1)+"</td><td> "+('<img src="/assets/img/avatar/'+
(e.avatar||0)+'.png" class="avatar"/> ')+"<span> "+c.fullname+"</span> </td><td>"+c.score+"</td><td>"+(c.level||1)+"</td></tr>"});a.tBody.html(b);var e=1;$.each(c.attempts,function(a,c){c.level>e&&(e=c.level)});a.data.maxLevelUser=e});if(b.urlVars.autoplay&&!b.data.numPlays){c=0;try{c=parseInt(b.urlVars.autoplay)}catch(e){}c&&(b.urlVars.test?a.goButton.trigger("click"):this.aboutToStart=window.setTimeout(function(){window.clearTimeout(this.aboutToStart);a.goButton.trigger("click")},3E3))}this.mainPanel.show()},
enable:function(a){this.goButton.prop("disabled",!a)},hide:function(){this.mainPanel&&this.mainPanel.fadeOut(250)},setTitle:function(a){this.title.html(a)}};b.TopBar=function(a){this.numLives=0;var c='<div id="topBar" class="topbar"><img id="avatar" class="avatar"/><span id="avatarLifes"></span><div class="progress"><div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div><center id="progressTpc"> 0% </center> </div><div class="topbar-left"><span class="picoin"></span> <span id="picoin-score" class="lcd">0</span><button class="btn btn-danger btn-sm glyphicon glyphicon-home"> <span class="hidden-xs">'+
b.getI18n("EXIT")+"</span> </button></div></div>";this.mainPanel=$(c);this.mainPanel.find("#avatar").attr("src",b.getUser().uopts.avatar?"/assets/img/avatar/"+b.getUser().uopts.avatar+".png":"/assets/img/avatar/0.png");this.mainPanel.prepend(this.icon);this.exitButton=this.mainPanel.find("button");this.exitButton.on("click",function(c){a&&a()});this.score=this.mainPanel.find("#picoin-score");this.progressBar=this.mainPanel.find(".progress-bar");this.progressBarTpc=this.mainPanel.find("#progressTpc");
this.lifes=this.mainPanel.find("#avatarLifes");$("body").append(this.mainPanel)};b.TopBar.prototype={show:function(){this.mainPanel||this.create();this.setScore(0);this.setProgress(0);this.mainPanel.show()},hide:function(){this.mainPanel&&this.mainPanel.fadeOut(250)},enableExit:function(a){this.exitButton.prop("disabled",!a)},setScore:function(a){this.score.text(a)},setLives:function(a){this.numLives=a;this.lifes.text("x"+a)},addLives:function(a){this.numLives+=a;switch(this.numLives){case 2:a="orange";
break;case 1:a="red";break;default:a="black"}this.lifes.css("color",a);this.lifes.text("x"+this.numLives);this.lifes.fadeOut(500).fadeIn(500)},getLives:function(){return this.numLives},setProgress:function(a,c){a=a||0;c=c||a+"%";this.progressBar.prop("aria-valuenow",a+"");this.progressBar.css("width",a+"%");this.progressBarTpc.html("<center>"+c+"</center>")}};b.GameOver={init:function(){var a='<div id="gameover" class="modal fade" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title">'+
b.getI18n("NO_LIFES")+'</h4></div><div class="modal-body"><center class="lcd"><h2>'+b.getI18n("GAME_OVER")+'</h2></center></div><div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">'+b.getI18n("CLOSE")+"</button></div></div></div></div>";this.modal=$(a);$("body").append(this.modal)},show:function(){this.modal||this.init();this.modal.modal()}};b.GenericModal={init:function(){var a='<div id="gameover" class="modal fade" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title"></h4></div><div class="modal-body"><center class="lcd"><h2></h2></center></div><div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">'+
b.getI18n("CLOSE")+"</button></div></div></div></div>";this.modal=$(a);$("body").append(this.modal)},show:function(a,c,b,d){this.modal||this.init();this.modal.find(".modal-title").html(a);this.modal.find(".modal-body h2").html(c);this.modal.modal();var f=this;b&&setTimeout(function(){f.modal.modal("hide")},b);if(d)this.modal.on("hidden.bs.modal",d);else this.modal.off("hidden.bs.modal")}};b.GameScreen=function(a,c,b){this.router=a;this.rest=c;this.resources=b;this.gameScreen=$("div#gameScreen");this.gameScreen[0]?
(this.gameScreen.css("display","none"),this.gameScreen.append('"<div class="before"></div><div class="after"></div>')):(this.gameScreen=$('<div id="gameScreen" style="display:none"><div class="before"></div><div class="after"></div></div>'),$("body").append(this.gameScreen))};b.GameScreen.prototype={destroy:function(){$("body").remove(this.gameScreen);this.gameScreen=null},show:function(){this.gameScreen&&(this.gameScreen.css("display",""),this.gameScreen.show())},hide:function(){this.gameScreen&&
this.gameScreen.fadeOut(250)},html:function(a){this.gameScreen&&this.gameScreen.html(a)},find:function(a){return this.gameScreen.find(a)},append:function(a){return this.gameScreen.append(a)},empty:function(){this.gameScreen.empty()},fireworks:function(){var a=this;this.gameScreen.addClass("pyro");$("body").css("overflow","hidden");window.setTimeout(function(){a.gameScreen.removeClass("pyro");$("body").css("overflow","")},2E3)}};b.EndScreen=function(a,c){var e='<div id="endScreen" style="display:none"><center><div class="panel panel-default theend"><div class="lcd"><h3>'+
b.getI18n("YOUR_SCORE")+'</h3> <h2> <span id="endScreenScore"></span>  <span class="picoin"></span> </h2></div><button id="homeBtn" class="btn btn-success btn-xl glyphicon glyphicon-home">'+b.getI18n("HOME")+'</button><br><div class"theend-ratepanel"><h2 class="lcd">'+b.getI18n("RATE")+'</h2><div id="theend-ratewidget"></div></div></center></div> </div>';this.mainPanel=$(e);$("body").append(this.mainPanel);this.goButton=this.mainPanel.find("#homeBtn");this.goButton.on("click",function(c){b.iframeAPI.send("onHome",
"");a.go("WelcomeScreen")});this.rateWidget=$("#theend-ratewidget");this.rateWidget.rateYo({numStars:5,starWidth:b.bowser.mobile?"20px":"40px",rating:0,precision:0});this.rateWidget.on("rateyo.set",function(a,b){c.updateRating(b.rating)})};b.EndScreen.prototype={destroy:function(){$("body").remove(this.mainPanel);this.goButton.off();this.mainPanel=null},show:function(){this.mainPanel&&(this.mainPanel.find("#endScreenScore").text(),this.mainPanel.show())},enable:function(a){this.goButton.prop("disabled",
!a)},hide:function(){this.mainPanel.fadeOut(250)},setRating:function(a){this.rateWidget.rateYo("option","rating",a)},setScore:function(a){this.mainPanel.find("#endScreenScore").text(a)}};b.recoverStorage=function(){var a=localStorage.getItem("pwSession");if(a&&!b.urlVars.guest)try{var c=b.decrypt(a),e=JSON.parse(c);m=e.user||{uopts:{}};m.isStore=!0;n=e.selectedGroup||{};grp=e.grp||{}}catch(d){m={uopts:{}},n={}}else m={uopts:{}},n={}};b.getUser=function(){m||b.recoverStorage();return m};b.getGroup=
function(){n||b.recoverStorage();return n};b.preloader={};b.preloader.imageLoader=function(a,c,e){function d(){p();b.log("image "+a+" resolved");r.resolve(l)}function f(){p();b.log("image "+a+" rejected");r.resolve(null)}function p(){e?l.oncanplaythrough=null:l.onload=null;l.onerror=null;l.onabort=null}var r=new $.Deferred,l;if(e){var x=a.lastIndexOf("."),q=a.substring(0,x),x=a.substring(x+1,a.length).toLowerCase().trim();l=document.createElement("AUDIO");if(!l.canPlayType("audio/"+x)){console.log("audio/"+
x+" is not supported");for(var g=0;g<b.Sound.fallback.length;g++){var y=b.Sound.fallback[g];if(y!==x&&l.canPlayType("audio/"+y)){console.log("Use fallback audio/"+y+" instead");a=q+"."+y;break}}}}else l=document.createElement("IMG");e?(l.preload="auto",b.log("sound "+a+" resolved"),r.resolve(l)):(l.onload=d,l.onerror=f,l.onabort=f);l.src=a;l.id=c||"img-"+Math.floor(1E6*Math.random());3<l.readyState&&(p(),defer.resolve(l));return r.promise()};b.preloader.resolverJS=function(a){var c=new $.Deferred,
b=Object.keys(a);if(0===b.length)return c.resolve({}),c.promise();require(Object.values(a),function(){for(var a=Array.prototype.slice.call(arguments),f={},p=0;p<a.length;p++)f[b[p]]=a[p];c.resolve(f)});return c.promise()};b.preloader.resolverServer=function(a){var c=new $.Deferred,e=Object.keys(a);a=Object.values(a);if(0===e.length)return c.resolve({}),c.promise();var d=[];$.each(a,function(a,c){var e=new $.Deferred;$.ajax({type:"POST",url:"/rest/fs/get",data:JSON.stringify({path:c,encrypt:!0,server:!0,
lang:b.getLang()}),contentType:"application/json"}).then(function(a){a=a.src;try{a=b.decrypt(a)}catch(d){console.log("Invalid encryption for ",c)}if(c.toLowerCase().endsWith(".json"))try{a=JSON.parse(a)}catch(f){console.log("INVALID JSON: ",f),console.log("Text: ",a)}e.resolve(a)});d.push(e.promise())});$.when.apply($,d).done(function(){var a={};$.each(arguments,function(c,b){a[e[c]]=b});c.resolve(a)});return c.promise()};b.preloader.resolverEqn=function(a,c){var e=new $.Deferred,d=Object.keys(a);
if(0===d.length)return e.resolve({}),e.promise();c.html=Object.values(a);$.ajax({type:"POST",url:"/rest/misc/latex2",data:JSON.stringify(c),contentType:"application/json"}).then(function(a){var p={};if(c.type&&"svg"===c.type){var r=[];$.each(a,function(a,c){r.push(b.preloader.imageLoader("data:image/svg+xml;base64,"+c))});b.log(r);$.when.apply($,r).done(function(){$.each(arguments,function(a,c){p[d[a]]=c});e.resolve(p)})}else $.each(a,function(a,c){p[d[a]]=c}),e.resolve(p)});return e.promise()};b.preloader.resolverImages=
function(a){var c=new $.Deferred,e=Object.keys(a);if(0===e.length)return c.resolve({}),c.promise();var d=[];$.each(e,function(c,e){var r=a[e],l=r.toLowerCase(),l=l.endsWith(".mp3")||l.endsWith(".mp4")||l.endsWith(".ogg")||l.endsWith(".wav");d.push(b.preloader.imageLoader(r,e,l))});$.when.apply($,d).done(function(){var d={},p={};$.each(arguments,function(c,b){d[e[c]]=b;var g=a[e[c]].toLowerCase();(g.endsWith(".mp3")||g.endsWith(".mp4")||g.endsWith(".ogg")||g.endsWith(".wav"))&&(p[e[c]]=b)});b.Sound.register(p);
c.resolve(d)});return c.promise()};b.preloader.load=function(a){var c=Object.keys(a),e=Object.values(a),d=new $.Deferred,f={},p={},g={},l={},k={};$.each(e,function(a,b){var d=b.toLowerCase().trim();d.startsWith("latexhtml!")?(e[a]=b.substring(10),p[c[a]]=e[a]):d.startsWith("latexsvg!")?(e[a]=b.substring(9),g[c[a]]=e[a]):d.startsWith("server!")?(e[a]=b.substring(7),l[c[a]]=e[a]):d.endsWith(".jpg")||d.endsWith(".jpeg")||d.endsWith(".png")||d.endsWith(".gif")||d.endsWith(".jpg")||d.endsWith(".svg")||
d.endsWith(".tiff")||d.endsWith(".mp3")||d.endsWith(".mp4")||d.endsWith(".ogg")||d.endsWith(".wav")?(d.startsWith("image!")&&(e[a]=e[a].substring(6)),k[c[a]]=e[a]):(d.endsWith(".json")?d.startsWith("json!")||(e[a]="json!"+b):d.endsWith(".css")&&!d.startsWith("css!")&&(b="css!"+b,e[a]=b),f[c[a]]=e[a])});$.when(b.preloader.resolverJS(f),b.preloader.resolverEqn(p,{alone:!0}),b.preloader.resolverEqn(g,{alone:!0,type:"svg"}),b.preloader.resolverServer(l),b.preloader.resolverImages(k)).done(function(a,
c,e,f,p){b.recoverStorage();a=$.extend(a,c,e,f,p);d.resolve(a)});return d.promise()};b.Rest=function(a,c){this.idActivity=a;this.idAssignment=c};b.Rest.prototype={getActivityInfo:function(){this.idUser=b.getUser().id||0;this.idRole=b.getUser().idRole;var a={idActivity:this.idActivity,idAssignment:this.idAssignment,idUser:this.idUser||0,lang:b.getLang()};return $.ajax({type:"POST",url:"/rest/activity/get",data:JSON.stringify(a),contentType:"application/json"})},createAttempt:function(){this.idUser=
b.getUser().id||0;this.idRole=b.getUser().idRole;if(!this.idUser||500===this.idRole)return g({idAttempt:0,msg:"offline"});var a={idActivity:this.idActivity,idAssignment:this.idAssignment,idLogin:b.getUser().idLogin,idGroup:b.getGroup().idGroup||0,level:0};return $.ajax({type:"POST",url:"/rest/attempt/create",data:JSON.stringify(a),contentType:"application/json"})},updateAttempt:function(a){this.idUser=b.getUser().id||0;this.idRole=b.getUser().idRole;return this.idUser&&500!==this.idRole?$.ajax({type:"POST",
url:"/rest/attempt/update",data:JSON.stringify(a),contentType:"application/json"}):g({msg:"offline"})},closeAttempt:function(a){this.idUser=b.getUser().id||0;this.idRole=b.getUser().idRole;return this.idUser&&500!==this.idRole?$.ajax({type:"POST",url:"/rest/attempt/close",data:JSON.stringify(a),contentType:"application/json"}):g({msg:"offline"})},openQuestion:function(a,c,e,d,f){this.idUser=b.getUser().id||0;this.idRole=b.getUser().idRole;return this.idUser&&500!==this.idRole?$.ajax({type:"POST",
url:"/rest/attempt/createQuestion",data:JSON.stringify({idAttempt:a,question:c,rightAnswer:e,category:d,level:f||1}),contentType:"application/json"}):g({idQuestion:0,msg:"offline"})},closeQuestion:function(a,c,e,d,f,p){this.idUser=b.getUser().id||0;this.idRole=b.getUser().idRole;return this.idUser&&500!==this.idRole?$.ajax({type:"POST",url:"/rest/attempt/closeQuestion",data:JSON.stringify({idQuestion:a,seconds:c,score:e,askTheory:d?1:0,askHelp:f?1:0,askAnswer:p?1:0}),contentType:"application/json"}):
g({msg:"offline"})},addAnswer:function(a,c,e){this.idUser=b.getUser().id||0;this.idRole=b.getUser().idRole;return this.idUser&&500!==this.idRole?$.ajax({type:"POST",url:"/rest/attempt/registerAnswer",data:JSON.stringify({idQuestion:a,answer:c,isCorrect:e?1:0}),contentType:"application/json"}):g({idAnswer:0,msg:"offline"})},updateRating:function(a){this.idUser=b.getUser().id||0;this.idRole=b.getUser().idRole;return this.idUser&&500!==this.idRole?$.ajax({type:"POST",url:"/rest/activity/updaterating",
data:JSON.stringify({idActivity:this.idActivity,idUser:this.idUser,rating:a||0}),contentType:"application/json"}):g({idAnswer:0,msg:"offline"})},top10:function(){this.idUser=b.getUser().id||0;return $.ajax({type:"POST",url:"/rest/attempt/top10",data:JSON.stringify({idActivity:this.idActivity,idUser:this.idUser,idAssignment:this.idAssignment}),contentType:"application/json"})}};b.Application=function(a,c){this.data={};this.idActivity=a;this.preload=c;this.rest=new b.Rest(a,b.urlVars.idAssignment||
0);this.router=new b.Router;this.LoadingPanel=new b.LoadingPanel;this.backgroundPanel=$('<div class="background-panel"></div>');$("body").append(this.backgroundPanel);if(b.FScreen.fullscreenEnabled()&&!b.iframeAPI.isIframe){var e=$('<button class="btn btn-default glyphicon glyphicon-resize-full"></button>'),d=$('<div class="btn-fullscreen"></div>');d.append(e);var f=$("body");f.append(d);e.on("click",function(a){b.FScreen.toggleFullscreen(f,e)});b.FScreen.setOnfullscreenchange(function(a){b.FScreen.fullscreenElement()||
b.FScreen.exitFullscreen()})}};b.Application.prototype={postBootstrap:function(){var a=this;window.renderMathInElement=window.renderMathInElement||this.data.bootstrap.katexauto;this.WelcomeScreen=new b.WelcomeScreen(this.router,function(c){b.iframeAPI.send("onPlay","");a.WelcomeScreen.aboutToStart&&window.clearInterval(a.WelcomeScreen.aboutToStart);a.rest.createAttempt().then(function(c){a.data.attempt=c;b.data.numPlays+=1;a.router.go("GameScreen");var d=new $.Deferred;a.GameScreen.data=a.data;a.stages.play(d,
a.GameScreen);d.promise().then(function(){b.iframeAPI.send("onEnd","");a.rest.closeAttempt(c);a.router.go("EndScreen");a.EndScreen.setRating(a.data.activityInfo.rating);a.EndScreen.setScore(c.score);b.data.attempt=null;var d=new $.Deferred;a.stages.afterEndscreen(d)})})},this.rest,this.data);this.GameScreen=new b.GameScreen(this.router,this.rest,this.data.bootstrap);this.EndScreen=new b.EndScreen(this.router,this.rest);this.router.setRoutes({LoadingPanel:this.LoadingPanel,WelcomeScreen:this.WelcomeScreen,
EndScreen:this.EndScreen,GameScreen:this.GameScreen})},bootstrap:function(){b.log("Called bootstrap");var a=new $.Deferred;this.LoadingPanel.show();b.getUser().id||this.LoadingPanel.danger("Usuari no identificat");var c=b.preloader.load(this.preload),e=this.rest.getActivityInfo(),d=this;$.when(c,e).done(function(c,e){b.log("Preload and activityInfo resolved");d.data.activityInfo=e[0];d.data.bootstrap=c;var g=d.data.bootstrap.quizz;"string"===typeof g?b.BrewJS(g).then(function(c){b.log("BrewJS resolved");
d.data.bootstrap.quizz=c;a.resolve(d.data);d.afterBootstrap()}):$.isArray(g)?(a.resolve(d.data),d.afterBootstrap()):g&&g.deps?b.preloader.resolverJS(g.deps||{}).then(function(c){b.log("Quizz Dependencies Resolved: ",c);d.data.quizzDeps=c;d.data.bootstrap.quizz=d.data.bootstrap.quizz.questions;a.resolve(d.data);d.afterBootstrap()}):console.log("bootstrap:: quizz Cannot be resolved");d.data.bootstrap.background&&(g=$(d.data.bootstrap.background),g.addClass("img img-responsive background-image"),d.backgroundPanel.append(g),
window.setTimeout(function(){d.backgroundPanel.css({"z-index":-1,opacity:0.5})},1500))});return a.promise()},afterBootstrap:function(){b.log("Called afterBootstrap");this.postBootstrap();var a=this,c=new $.Deferred;this.stages.afterBootstrap(c);c.promise().then(function(){b.log("stages.afterBootstrap resolved");var c=new $.Deferred;a.stages.afterWelcomescreen(c);c.promise().then(function(){b.log("stages.afterWelcomeScreen resolved");a.router.go("WelcomeScreen");a.WelcomeScreen.setTitle("<h4 class='activityTitle'>"+
a.data.activityInfo.activity+"</h4>");a.WelcomeScreen.enable(!0)})})},stages:{afterBootstrap:function(a){a.resolve()},afterWelcomescreen:function(a){a.resolve()},play:function(a,c){a.resolve()},afterEndscreen:function(a){a.resolve()}}};b.GameInterface=function(){};b.GameInterface.prototype={createQuestion:function(a){a.resolve()},check:function(a){a.resolve()},next:function(){},exit:function(){},destroy:function(){}};b.fixKAS=function(a){return(a||"").replace(/\\sqrt\{/g,"\\sqrt[2]{").replace(/\\, /g,
"").replace(/\\,/g,"").replace(/\(\s*\)/g,"").replace(/\\left\(\s*\\right\)/g,"")};window.pw=b})();(function(g){g.KATEXAUTO_OPTIONS={delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]};g.JSXGraph_OPTS={boundingbox:[-10,10,10,-10],axis:!0,showCopyright:!1,showNavigation:!0,zoom:!0,pan:!0};g.autoRenderJSXGraph=function(w){var m=w.find(".jxgbox-container");m.length&&require(["jsxgraph","KAS"],function(){$.each(m,function(m,k){var b=$(k);if(0===b.find(".jxgbox").length){var s=k.innerHTML||"";b.empty().removeClass("pw-cloak").css("display",
"");var h="jxgbox-"+Math.random().toString(36).substring(2);b.append('<div id="'+h+'" class="jxgbox" style="width:100%;height:100%;"></div>');var u={};if(k.dataset.options)try{u=eval(k.dataset.options)}catch(v){console.log(v)}var t=$.extend(u,g.JSXGraph_OPTS);if(k.dataset.boxrange)try{var a=eval(k.dataset.boxrange);if($.isArray(a)){var c;switch(a.length){case 1:var e=a[0];c=[-e,e,e,-e];break;case 2:var e=a[0],d=a[1];c=[-e,d,e,-d];case 3:var e=a[0],d=a[1],f=a[2];c=[e,f,d,-f];case 4:c=[a[0],a[3],a[1],
a[2]]}c&&(t.boundingbox=c)}}catch(p){console.log(p)}console.log("init board ",h,t);var r=JXG.JSXGraph.initBoard(h,t);k.board=r;h=new g.Script({board:r,KAS:KAS});console.log("Run code",s);h.runInContext(s);h.destroy();b.on("resize",function(){r.resizeContainer(r.containerObj.clientWidth,r.containerObj.clientHeight,!0);r.setBoundingBox(t.boundingbox);r.fullUpdate()})}})})};g.autoRender=function(w){g.autoRenderJSXGraph(w);window.renderMathInElement&&window.renderMathInElement(w[0],g.KATEXAUTO_OPTIONS)}})(window.pw);/*
 MIT
*/
function navigatorLang(){return void 0!=navigator.languages?navigator.languages[0]:navigator.language}
(function(g){function w(){var a=4022871197;return function(c){c=c.toString();for(var b=0;b<c.length;b++){a+=c.charCodeAt(b);var d=0.02519603282416938*a;a=d>>>0;d-=a;d*=a;a=d>>>0;d-=a;a+=4294967296*d}return 2.3283064365386963E-10*(a>>>0)}}String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(a){return 0===this.toString().indexOf(a)}});String.prototype.endsWith||Object.defineProperty(String.prototype,"endsWith",{value:function(a,c){var b=this.toString();if("object"===
typeof a){var d=!1,f;for(f in a)if(b.endsWith(a[f])){d=!0;break}return d}if(void 0===c||c>b.length)c=b.length;c-=a.length;b=b.indexOf(a,c);return-1!==b&&b===c}});String.prototype.repeat||(String.prototype.repeat=function(a){return Array(a+1).join(this)});String.prototype.html2latex=function(){return this.replace(/<katex>/gi,"$").replace(/<\/katex>/gi,"$")};Object.values||(Object.values=function(a){var c=[],b;for(b in a)c.push(a[b]);return c});Array.prototype.random||Object.defineProperty(Array.prototype,
"random",{value:function(){return this[Math.floor(Math.random()*this.length)]}});Array.prototype.equals||(Array.prototype.equals=function(a,c){if(!a)return!1;1===arguments.length&&(c=!0);if(this.length!==a.length)return!1;for(var b=0;b<this.length;b++)if(this[b]instanceof Array&&a[b]instanceof Array){if(!this[b].equals(a[b],c))return!1}else{if(c&&this[b]!==a[b])return!1;if(!c)return this.sort().equals(a.sort(),!0)}return!0});Array.prototype.clear||(Array.prototype.clear=function(){this.splice(0,this.length)});
Array.prototype.shuffle||(Array.prototype.shuffle=function(){var a=this.length,c,b;if(0===a)return this;for(;--a;)c=Math.floor(Math.random()*(a+1)),b=this[a],this[a]=this[c],this[c]=b;return this});Array.prototype.forEach||(Array.prototype.forEach=angular.forEach);Element.prototype.remove||(Element.prototype.remove=function(){this.parentNode.removeChild(this)});Math.ln||(Math.ln=Math.log);Math.power=function(a,c){return Math.exp(c*Math.log(a))};Math.logb||(Math.logb=function(a,c){return Math.log(a)/
Math.log(c||10)});Math.root||(Math.root=function(a,c){return Math.power(a,1/c)});Math.srandom||(Math.srandom=function(){return Math.random().toString(36).slice(2)});Math.irandom||(Math.irandom=function(a,c){a=a||0;c=c||10;return Math.floor(Math.random()*(c-a))+a});Math.seed||(Math.seed=function(a){this.seed=a;this.random=function(a){a=a||1;for(var b=Array(a),d=0;d<a;d++)this.seed=(9301*this.seed+49297)%233280,b[d]=this.seed/233280;return 1<a?b:b[0]};return this});Math.fact||(Math.fact=function(a){return"number"!==
typeof a||0>a?!1:0===a?1:a*Math.fact(a-1)});Math.binomial||(Math.binomial=function(a,c){if("number"!==typeof a||"number"!==typeof c||a<c)return!1;for(var b=1,d=a-c+1;d<=a;d++)b*=d;for(d=1;d<=c;d++)b/=d;return b});(function(){function a(a,c){return function(){var b=this._super;this._super=c;var e=a.apply(this,arguments);this._super=b;return e}}var c=Object.prototype.hasOwnProperty,b="get set value writable enumerable configurable".split(" ");"function"!==typeof Object.extend&&(Object.extend=function(d,
f,g){function k(){this.constructor=m}var l,m;"function"!==typeof d&&3>arguments.length&&(g=f,f=d,d=function(){});f||(f={});g||(g={});m=function(){this.init&&this.init.apply(this,arguments)};for(var q in d)c.call(d,q)&&(m[q]=d[q]);for(q in g)m[q]=g[q];k.prototype=d.prototype;l=new k;for(q in f)if("$"!==q.substr(0,1)||"object"!==typeof f[q]&&"function"!==typeof f[q])l[q]="function"===typeof f[q]&&"function"===typeof l[q]?a(f[q],d.prototype[q]):f[q];else{var h=f[q];q=q.substr(1);"function"===typeof h&&
(h=h());var n=Object.getOwnPropertyDescriptor(d.prototype,q);if(n){var s=c.call(h,"value")||c.call(h,"writable"),t=c.call(h,"get")||c.call(h,"set");b.forEach(function(b){"get"===b||"set"===b?s||"function"===typeof n[b]&&(h[b]="function"===typeof h[b]?a(h[b],n[b]):n[b]):"value"===b||"writable"===b?t||!c.call(h,b)&&c.call(n,b)&&(h[b]=n[b]):!c.call(h,b)&&c.call(n,b)&&(h[b]=n[b])})}Object.defineProperty(l,q,h)}m.prototype=l;m.__super__=d.prototype;m.extend=function(a,b){return Object.extend(m,a,b)};return m})})();
g.isMobile=function(){return/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)};g.testEmail=function(a){return RegExp(/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/i).test(a)};g.bindEvent=function(a,b,e){a.addEventListener?a.addEventListener(b,e,!1):a.attachEvent&&a.attachEvent("on"+b,e)};g.unbindEvent=function(a,b){a.removeEventListener?a.removeEventListener(b):a.detachEvent&&a.detachEvent("on"+b)};var m={isIframe:window.parent&&window.parent!==window&&window.location.origin===window.parent.location.origin,
initialized:!1,listeners:[],init:function(){m.initialized||(g.bindEvent(window,"message",function(a){var b;try{b=JSON.parse(a.data),$.each(m.listeners,function(a,e){e(b.key,b.msg)})}catch(e){console.log(a.data,e)}}),m.initialized=!0)},destroy:function(){g.bindEvent(window,"message")},attachListener:function(a){m.initialized||m.init();m.listeners.push(a)},send:function(a,b,e){m.isIframe||e?(a={key:a,msg:b},e||(e=window.parent),e.postMessage||(e=e.contentWindow),e.postMessage(JSON.stringify(a),"*")):
console.log("isIframe?",m.isIframe,"You must provide an iframe to send to")}};g.iframeAPI=m;var n={fullscreenEnabled:0,fullscreenElement:1,requestFullscreen:2,exitFullscreen:3,fullscreenchange:4,fullscreenerror:5},k="webkitFullscreenEnabled webkitFullscreenElement webkitRequestFullscreen webkitExitFullscreen webkitfullscreenchange webkitfullscreenerror".split(" "),b="mozFullScreenEnabled mozFullScreenElement mozRequestFullScreen mozCancelFullScreen mozfullscreenchange mozfullscreenerror".split(" "),
s="msFullscreenEnabled msFullscreenElement msRequestFullscreen msExitFullscreen MSFullscreenChange MSFullscreenError".split(" "),h="fullscreenEnabled"in document&&Object.keys(n)||k[0]in document&&k||b[0]in document&&b||s[0]in document&&s||[],u,v,t={toggleFullscreen:function(a,b){u?a===u?t.exitFullscreen(a):(t.exitFullscreen(),t.requestFullscreen(a,b)):t.requestFullscreen(a,b)},requestFullscreen:function(a,b){b&&b.removeClass("glyphicon-resize-full");u=a;b&&b.addClass("glyphicon-resize-small");v=b;
if(t.fullscreenEnabled())return a[0][h[n.requestFullscreen]]();a.addClass("fullscreen-max")},exitFullscreen:function(a,b){v&&v.removeClass("glyphicon-resize-small").addClass("glyphicon-resize-full");u=null;if(t.fullscreenEnabled())return document[h[n.exitFullscreen]].bind(document)();a.removeClass("fullscreen-max")},addEventListener:function(a,b,e){return document.addEventListener(h[n[a]],b,e)},removeEventListener:function(a,b,e){return document.removeEventListener(h[n[a]],b,e)},fullscreenEnabled:function(){return Boolean(document[h[n.fullscreenEnabled]])},
fullscreenElement:function(){return document[h[n.fullscreenElement]]},getOnfullscreenchange:function(){return document[("on"+h[n.fullscreenchange]).toLowerCase()]},setOnfullscreenchange:function(a){return document[("on"+h[n.fullscreenchange]).toLowerCase()]=a},getOnfullscreenerror:function(){return document[("on"+h[n.fullscreenerror]).toLowerCase()]},setOnfullscreenerror:function(a){return document[("on"+h[n.fullscreenerror]).toLowerCase()]=a}};g.FScreen=t;g.Sound={categories:{sounds:["soundRightAnswer",
"soundWrongAnswer","soundTimeout","ok","wrong"],themes:["soundGameOver","theme1","theme2","theme3"]},volumeSounds:1,volumeThemes:0.6,enableSounds:!0,enableThemes:!0,enable:{sounds:function(a){g.Sound.enableSounds=a},themes:function(a){g.Sound.enableThemes=a}},fallback:["mp3","ogg"],sounds:{},playing:[],register:function(a){var b=this;$.each(Object.keys(a),function(e,d){if(!b.sounds[d]){var f=a[d];if("string"===typeof f){var g=f.lastIndexOf("."),k=f.substring(0,g),g=f.substring(g+1,f.length).toLowerCase().trim(),
l=document.createElement("AUDIO");if(!l.canPlayType("audio/"+g))for(console.log("audio/"+g+" is not supported"),e=0;e<pw.Sound.fallback.length;e++){var h=pw.Sound.fallback[e];if(h!==g&&l.canPlayType("audio/"+h)){console.log("Use fallback audio/"+h+" instead");f=k+"."+h;break}}l.preload="auto";l.src=f;b.sounds[d]=l}else b.sounds[d]=f}})},play:function(a,b,e){if(!(!this.enableSounds&&0<=this.categories.sounds.indexOf(a)||!this.enableThemes&&0<=this.categories.themes.indexOf(a))){var d=this,f=this.sounds[a];
f?(a=d.categories.themes.indexOf(a),f.volume=e||(a?d.volumeThemes:d.volumeSounds),b&&(f.loop=b,f.loopCount=0),f.play(),f.onended=function(){f.currentTime=0;if(0<f.loop&&f.loopCount<f.loop||0>f.loop)f.loopCount+=1,f.play();else{var a=d.playing.indexOf(f);0<=a&&d.playing.splice(a,1);f.onended=null}},this.playing.push(f)):console.log("Unregistered sound ",a,". Use ",Object.keys(this.sounds))}},stop:function(a){if(a){if(a=this.sounds[a])a.pause(),a.currentTime=0,a=this.playing.indexOf(a),0<=a&&this.playing.splice(a,
1)}else $.each(this.playing,function(a,b){b.pause();b.loop=0;b.loopCount=0;b.onended=null;b.currentTime=0}),this.playing.splice(0,this.playing.length)}};g.Alea=function(a){var b=this,e=w();b.next=function(){var a=2091639*b.s0+2.3283064365386963E-10*b.c;b.s0=b.s1;b.s1=b.s2;return b.s2=a-(b.c=a|0)};b.c=1;b.s0=e(" ");b.s1=e(" ");b.s2=e(" ");b.s0-=e(a);0>b.s0&&(b.s0+=1);b.s1-=e(a);0>b.s1&&(b.s1+=1);b.s2-=e(a);0>b.s2&&(b.s2+=1);e=null};g.encrypt=function(a){for(var b=new g.Alea("jl8jKsYDwB"),e=a.length,
d=Array(e),f=0;f<e;f++){var h=a.charCodeAt(f);if(32<=h&&126>=h){var k=Math.floor(93*b.next());d[f]=(h+k-32)%94+32}else d[f]=h}return String.fromCharCode.apply(String,d)};g.decrypt=function(a){for(var b=Array(e),e=a.length,d=new g.Alea("jl8jKsYDwB"),f=0;f<e;f++){var h=a.charCodeAt(f);if(32<=h&&126>=h){var k=Math.floor(93*d.next());b[f]=(h-k-32+94)%94+32}else b[f]=h}return String.fromCharCode.apply(String,b)};k=new Date;k.setDate(k.getDate()-244);g.currentYear=k.getFullYear()-2E3;g.guid=function(){return Math.random().toString(36).slice(2)}})(window.pw||
window);
